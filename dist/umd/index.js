!function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e(require("react")):"function"===typeof define&&define.amd?define(["react"],e):"object"===typeof exports?exports.ReactAsyncState=e(require("react")):t.ReactAsyncState=e(t.react)}(self,(function(t){return(()=>{"use strict";var e={297:e=>{e.exports=t}},r={};function n(t){var o=r[t];if(void 0!==o)return o.exports;var i=r[t]={exports:{}};return e[t](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var o={};return(()=>{n.r(o),n.d(o,{AsyncStateBuilder:()=>at,AsyncStateProvider:()=>tt,AsyncStateStatus:()=>u,createAsyncState:()=>ct,createReducerAsyncState:()=>st,createReducerPromise:()=>d,useAsyncState:()=>q,useAsyncStateSelector:()=>ut});var t=!1,e=Object.freeze([]),r=Object.freeze({});function i(t,e){return Object.assign({},t,e)}var u={error:"error",loading:"loading",success:"success",aborted:"aborted",initial:"initial"};function a(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Promise.resolve().then((function(){s.apply(void 0,[t].concat(r))}))}}function c(){}function s(t){if("function"===typeof t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.apply(void 0,r)}}function l(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return f(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function y(t){return(y="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t){if("function"!==typeof t)throw new Error("Reducer Promise creator expects reducerFn to be a function, received ".concat(y(t)));return function(e){return t.apply(void 0,[e.lastSuccess].concat(l(e.executionArgs)))}}var p=n(297),v=n.n(p),b=v().createContext(null);function h(t,e,r){return Object.freeze({status:t,data:e,args:r})}var S=Object.freeze({initial:function(t){return h(u.initial,t,null)},error:function(t,e){return h(u.error,t,e)},success:function(t,e){return h(u.success,t,e)},loading:function(t){return h(u.loading,null,t)},aborted:function(t,e){return h(u.aborted,t,e)}});function m(t){Object.values(t.subscriptions).forEach((function(e){s(e.callback,t.currentState)}))}var g=Object.freeze({trace:{order:1,value:"trace"},debug:{order:2,value:"debug"},info:{order:3,value:"info"},warn:{order:4,value:"warn"},error:{order:5,value:"error"}}),O=process.env.IS_LOGGER_ENABLED||t,A=process.env.LOG_LEVEL||g.trace.value;!function(t){if(!t)return{trace:c,debug:c,info:c,warn:c,error:c};r("Logger is enabled!");var e=g[A];function r(){var t;return(t=console).log.apply(t,arguments)}function n(t,r){return function(){e.order<=t.order&&r.apply(void 0,arguments)}}n(g.trace,r),n(g.debug,r),n(g.info,r),n(g.warn,(function(){var t;return(t=console).warn.apply(t,arguments)})),n(g.error,(function(){var t;return(t=console).error.apply(t,arguments)}))}(O);function k(e,r){t}function w(e,r){t}function j(e){t}function E(e,r){t}var I=Object.freeze({lazy:!0,initialValue:null});function P(t,e,r){var n;this.key=t,this.config=i(I,r),this.originalPromise=e,this.lastSuccess=void 0,this.currentState=S.initial(this.config.initialValue),this.forkCount=0,this.subscriptionsMeter=0,this.subscriptions={},this.promise=(n=this,function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.setState(S.loading(e)),Promise.resolve(n.originalPromise.apply(n,e)).then((function(t){e[0].aborted||n.setState(S.success(t,e))})).catch((function(t){e[0].aborted||n.setState(S.error(t,e))}))}),this.__IS_FORK__=!1,this.payload=null,this.currentAborter=null,this.locks=0,Object.preventExtensions(this)}P.prototype.setState=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.currentState="function"===typeof t?t(this.currentState):t,k(this.key,this.currentState),this.currentState.status===u.success&&(this.lastSuccess=i(this.currentState)),e&&m(this)},P.prototype.abort=function(t){s(this.currentAborter,t)},P.prototype.dispose=function(){return this.key,this.locks,!(this.locks>0)&&(this.locks=0,t=this,Object.values(t.subscriptions).forEach((function(t){s(t.cleanup)})),this.subscriptions={},this.setState(S.initial(this.config.initialValue)),!0);var t},P.prototype.run=function(){this.currentState.status===u.loading&&(j(this.key),this.abort(),this.currentAborter=null);for(var t=this,e=null,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];var a={abort:c,aborted:!1,payload:this.payload,executionArgs:n,lastSuccess:i(this.lastSuccess),onAbort:function(t){e=t}};function c(r){a.aborted||(a.aborted=!0,E(t.key),t.setState(S.aborted(r,a)),s(e))}return w(this.key),this.promise(a),this.currentAborter=c,c},P.prototype.subscribe=function(t){var e=this;this.subscriptionsMeter+=1;var r="".concat(this.key,"-sub-").concat(this.subscriptionsMeter);function n(){e.locks-=1,delete e.subscriptions[r]}return this.subscriptions[r]={cleanup:n,callback:t,key:r},this.locks+=1,n};var T=Object.freeze({keepState:!1});P.prototype.fork=function(t){var e,r=i(T,t),n=new P("".concat((e=this).key,"-fork-").concat(e.forkCount+1),this.originalPromise,this.config);return this.forkCount+=1,r.keepState&&(n.currentState=i(this.currentState),n.lastSuccess=i(this.lastSuccess)),n.__IS_FORK__=!0,n},P.prototype.replaceState=function(t){this.currentState.status===u.loading&&(this.abort(),this.currentAborter=null);var e=t;"function"===typeof t&&(e=t(this.currentState)),this.key,this.setState(S.success(e))};const z=P;var N=Object.freeze({error:!0,success:!0,aborted:!0,loading:!0}),C=Object.freeze({LISTEN:0,HOIST:1,STANDALONE:2,WAITING:3,FORK:4,NOOP:5});function R(t,e){return Object.freeze({key:t.key,run:t.run.bind(t),abort:t.abort.bind(t),replaceState:t.replaceState.bind(t),runAsyncState:e?e.runAsyncState:void 0,state:Object.freeze(i(t.currentState)),lastSuccess:Object.freeze(i(t.lastSuccess))})}function x(){}var L=new z("waiting_async_state",(function(){return new Promise(x)}),{});function _(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function V(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?_(Object(r),!0).forEach((function(e){M(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function M(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function F(t,e,n,o,u){var a=v().useState(r)[1],c=v().useRef();return v().useLayoutEffect((function(){if(t){var e=n.rerenderStatus,o=V(V({},N),null!==e&&void 0!==e?e:r),i=t.subscribe((function(e){o[e.status]&&(c.current=R(t),a({}))}));return function(){s(i),"function"===typeof u?u(t):t.dispose()}}}),[t]),v().useEffect((function(){if(t&&n.condition&&!t.config.lazy)return t.payload=i(t.payload,n.payload),"function"===typeof o?o(t):t.run()}),e),c.current||(c.current=R(t)),c.current}function D(t,e){var r=function(t,e){var r=e.fork,n=e.hoistToProvider,o=!!t.get(e.key);return!o||n||r?n||r?!n||o&&r?r&&o?C.FORK:o?C.NOOP:C.WAITING:C.HOIST:C.STANDALONE:C.LISTEN}(t,e),n=function(t,e,r){var n=r.get(e.key);switch(t){case C.FORK:return r.fork(e.key,e.forkConfig);case C.HOIST:return r.hoist(e);case C.LISTEN:return n;case C.WAITING:return L;case C.STANDALONE:return new z(e.key,e.promise,function(t){return{lazy:t.lazy,initialValue:t.initialValue}}(e));case C.NOOP:return null;default:return n}}(r,e,t);return{mode:r,asyncState:n,run:function(){switch(r){case C.STANDALONE:return n.run();case C.FORK:case C.HOIST:case C.LISTEN:return t.run(n);case C.NOOP:case C.WAITING:default:return}},dispose:function(){switch(r){case C.STANDALONE:return n.dispose();case C.FORK:case C.HOIST:case C.LISTEN:return t.dispose(n);case C.NOOP:case C.WAITING:default:return}}}}function G(t){return function(t){if(Array.isArray(t))return W(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||K(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],u=!0,a=!1;try{for(r=r.call(t);!(u=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);u=!0);}catch(t){a=!0,o=t}finally{try{u||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||K(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(t,e){if(t){if("string"===typeof t)return W(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?W(t,e):void 0}}function W(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function U(t,e){var n=t.key,o=H(v().useState(r),2),i=o[0],u=o[1],a=v().useContext(b),c=[a,i].concat(G(e)),l=v().useMemo((function(){return D(a,t)}),c);return v().useLayoutEffect((function(){if(l.mode===C.WAITING){var t=a.waitFor(n,(function(){u({})}));return function(){s(t)}}}),[l.asyncState]),F(l.asyncState,e,t,l.run,l.dispose)}function $(t,e){return F(v().useMemo((function(){var e=t.key,r=t.promise,n=t.lazy,o=t.initialValue;return new z(e,r,{lazy:n,initialValue:o})}),e),e,t)}function q(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=v().useContext(b),o=v().useMemo((function(){return J(t)}),r),i=null!==n;return i?U(o,r):$(o,r)}var B=Object.freeze({lazy:!0,fork:!1,condition:!0,hoistToProvider:!1,forkConfig:r,hoistToProviderConfig:r,rerenderStatus:N,promise:function(){}});function J(t){return"function"===typeof t?J(t()):i(B,"string"===typeof t?{key:t}:t)}function Q(t){return{value:t,scheduledRunsCount:0}}function X(t,e){var r=e.key,n=e.promise,o=e.lazy,i=e.initialValue;return t[e.key]=Q(new z(r,n,{lazy:o,initialValue:i})),t[e.key].initiallyHoisted=!0,t}function Y(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];if(t){t.scheduledRunsCount+=1;var o=!1,i=!1;return a(c)(),u}function u(){if(!i){i=!0;var e=t.value;o&&!Z(e)&&e.abort(),t.scheduledRunsCount>=1&&(t.scheduledRunsCount-=1)}}function c(){var e;i||(1===t.scheduledRunsCount?(o=!0,(e=t.value).run.apply(e,r),t.scheduledRunsCount=0):t.scheduledRunsCount-=1)}}function Z(t){return Object.keys(t.subscriptions).length>0}function tt(t){var n=t.payload,o=void 0===n?r:n,u=t.children,a=t.initialAsyncStates,c=void 0===a?e:a,s=v().useMemo((function(){return c.reduce(X,{})}),[c]);v().useLayoutEffect((function(){s&&Object.values(s).forEach((function(t){t.value.payload=i(t.value.payload,o)}))}),[o]),v().useEffect((function(){if(s)return function(){Object.values(s).forEach((function(t){l.dispose(t.value)}))}}),[s]);var l=v().useMemo((function(){var t=function(t){function e(e){var r;return null===(r=t[e])||void 0===r?void 0:r.value}function r(e){for(var r=t[e.key],n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return Y.apply(void 0,[r].concat(o))}function n(e){var r=e.key,n=t[r];if(!n)return!1;var o=n.value.dispose();return!n.initiallyHoisted&&o&&delete t[r],o}var o={};return{run:r,get:e,fork:function(r,n){var o=e(r);if(o){var i=o.fork(n);return t[i.key]=Q(i),i}},hoist:function(r){var i=r.key,u=r.hoistToProviderConfig,a=void 0===u?{override:!1}:u,c=r.promise,s=r.lazy,l=r.initialValue,f=e(i);if(f&&!a.override)return f;if(f&&!n(f))return f;t[i]=Q(new z(i,c,{lazy:s,initialValue:l}));var y=e(i);return o[i]&&Object.values(o).forEach((function(t){t.notify(y)})),y},dispose:n,waitFor:function(t,e){o[t]||(o[t]={meter:0});var r=o[t],n=++r.meter;function i(){delete r[n]}return r[n]={notify:e,cleanup:i},i},runAsyncState:function(t){var n=e(t);if(n){for(var o=arguments.length,i=new Array(o>1?o-1:0),u=1;u<o;u++)i[u-1]=arguments[u];return r.apply(void 0,[n].concat(i))}}}}(s);return{payload:o,get:t.get,run:t.run,fork:t.fork,hoist:t.hoist,waitFor:t.waitFor,dispose:t.dispose,runAsyncState:t.runAsyncState}}),[s,o]);return v().createElement(b.Provider,{value:l},u)}function et(t){return function(t){if(Array.isArray(t))return ot(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||nt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],u=!0,a=!1;try{for(r=r.call(t);!(u=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);u=!0);}catch(t){a=!0,o=t}finally{try{u||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||nt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nt(t,e){if(t){if("string"===typeof t)return ot(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ot(t,e):void 0}}function ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function it(t,e){return t===e}function ut(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:it,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,o=v().useContext(b),i=o.get,u=o.waitFor,a=o.dispose,c="string"===typeof t?[t]:t,l=v().useState((function(){return p()||n})),f=rt(l,2),y=f[0],d=f[1];function p(){var t=e.apply(void 0,et(c.map((function(t){var e=i(t);if(e)return e.currentState}))));return r(y,t)?y:t}return v().useEffect((function(){var t=[];function e(){d(p())}return c.forEach((function(r){var n=i(r);n?(t.push(n.subscribe(e)),t.push((function(){a(n)}))):t.push(u(r,e))})),function(){t.forEach(s)}}),[].concat(et(c),[e])),y}function at(){var t={lazy:!0,initialValue:null};function e(e){return function(n){return t[e]=n,r}}var r={};return r.key=e("key"),r.lazy=e("lazy"),r.promise=e("promise"),r.initialValue=e("initialValue"),r.build=function(){return t},r}function ct(t,e,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return at().key(t).lazy(n).promise(e).initialValue(r).build()}function st(t,e,r,n){return ct(t,d(e),r,n)}})(),o})()}));